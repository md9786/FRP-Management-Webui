<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings</title>
  <script src="https://cdn.tailwindcss.com"></script>
<style>
  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: linear-gradient(180deg, #0f172a 0%, #0b0f1a 50%, #1e1b2e 100%);
    color: #f1f5f9;
  }

  .card {
    background: linear-gradient(135deg, #1e293b 0%, #111827 100%);
  }

  /* Indigo Primary Button */
  .btn-primary {
    background: linear-gradient(90deg, #4338ca 0%, #312e81 100%);
    transition: background 0.2s ease, transform 0.2s ease;
    border: none;
  }
  .btn-primary:hover {
    background: linear-gradient(90deg, #4f46e5 0%, #3730a3 100%);
    transform: translateY(-2px);
  }
  .btn-primary:active {
    background: linear-gradient(90deg, #6366f1 0%, #4338ca 100%);
  }

  /* Neutral Gray Secondary */
  .btn-secondary {
    background: linear-gradient(90deg, #334155 0%, #1e293b 100%);
    transition: background 0.2s ease, transform 0.2s ease;
    border: none;
  }
  .btn-secondary:hover {
    background: linear-gradient(90deg, #475569 0%, #334155 100%);
    transform: translateY(-2px);
  }
  .btn-secondary:active {
    background: linear-gradient(90deg, #64748b 0%, #475569 100%);
  }
  
  .error-alert {
    background: linear-gradient(90deg, #dc2626 0%, #b91c1c 100%);
    border: 1px solid #f87171;
  }

  /* Form Inputs */
  .form-control {
    background-color: #1e293b;
    border: 1px solid #334155;
    color: #e2e8f0;
    transition: border-color 0.2s ease;
  }
  .form-control:focus {
    background-color: #1e293b;
    border-color: #6366f1;
    color: #f1f5f9;
    outline: none;
    box-shadow: none;
  }
  .form-label { color: #94a3b8; }

  /* Floating Background Icons */
  .content-wrapper { position: relative; z-index: 2; }
  .floating-icons { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: 1; }
  .floating-icon { position: absolute; opacity: 0.05; font-size: 6rem; animation: float 6s ease-in-out infinite; color: #6366f1; }
  .floating-icon:nth-child(1) { top: 40%; left: 80%; animation-delay: 0s; }
  .floating-icon:nth-child(2) { top: 60%; left: 67%; animation-delay: 1s; }
  .floating-icon:nth-child(3) { top: 40%; left: 54%; animation-delay: 2s; }
  .floating-icon:nth-child(4) { top: 60%; left: 41%; animation-delay: 3s; }
  .floating-icon:nth-child(5) { top: 40%; left: 28%; animation-delay: 4s; }
  .floating-icon:nth-child(6) { top: 80%; left: 54%; animation-delay: 5s; }
  @keyframes float { 0%, 100% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-20px) rotate(5deg); } }
</style>

</head>
<body class="text-gray-100 min-h-screen">
  <div class="floating-icons" id="floating-icons-container"></div>

  <div class="content-wrapper">
    <div class="flex">
        {{template "sidebar.html" .}}
        <main class="flex-1 p-8">
            <div class="max-w-xl mx-auto">
                <h1 class="text-2xl font-semibold text-gray-100 mb-6">Settings</h1>

                {{ if .Error }}
                <div class="error-alert rounded-lg p-3 mb-6 text-sm text-white">
                  <div class="flex items-center">
                    <svg class="w-4 h-4 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                    </svg>
                    {{ .Error }}
                  </div>
                </div>
                {{ end }}

                <form id="settings-form" method="post" action="/settings" class="card rounded-xl p-6 shadow-lg space-y-6">
                    <div>
                        <label for="new_username" class="form-label block text-sm font-medium mb-2">Username</label>
                        <input type="text" id="new_username" name="new_username" value="{{ .Username }}" required class="form-control w-full p-3 rounded-lg text-sm" />
                    </div>
                    <div>
                        <label for="current_password" class="form-label block text-sm font-medium mb-2">Current Password (Required to make changes)</label>
                        <input type="password" id="current_password" name="current_password" required class="form-control w-full p-3 rounded-lg text-sm" placeholder="Enter your current password" />
                    </div>
                    <hr class="border-gray-600">
                    <div>
                        <label for="new_password" class="form-label block text-sm font-medium mb-2">New Password</label>
                        <input type="password" id="new_password" name="new_password" class="form-control w-full p-3 rounded-lg text-sm" placeholder="Leave blank to keep current password" />
                    </div>
                    <div>
                        <label for="confirm_password" class="form-label block text-sm font-medium mb-2">Confirm New Password</label>
                        <input type="password" id="confirm_password" name="confirm_password" class="form-control w-full p-3 rounded-lg text-sm" placeholder="Confirm new password" />
                    </div>
                    <div class="flex space-x-4 pt-4">
                        <button type="submit" class="btn-primary px-4 py-2 rounded-lg text-white font-medium">Save Changes</button>
                        <a href="/" class="btn-secondary px-4 py-2 rounded-lg text-gray-200 text-center">Back</a>
                    </div>
                </form>
            </div>
        </main>
    </div>
  </div>
  <script>
    document.getElementById('settings-form').addEventListener('submit', function(e) {
        const newPassword = document.getElementById('new_password').value;
        const confirmPassword = document.getElementById('confirm_password').value;

        if (newPassword !== confirmPassword) {
            alert('New passwords do not match.');
            e.preventDefault();
        }
    });

    document.addEventListener('DOMContentLoaded', function() {
      const container = document.getElementById('floating-icons-container');
      if (container) {
        const techEmojis = ['💻', '🖥️', '💾', '💿', '🔌', '📡', '🛰️', '🚀', '⚙️', '🔧', '🔬', '💡', '📈', '📊', '🔗', '🌐', '☁️', '⚡️', '🤖', '👾', '📱', '⌨️', '🖱️', '🔋', '🧠'];
        const iconCount = 6;
        let iconsHtml = '';
        for (let i = 0; i < iconCount; i++) {
          const randomEmoji = techEmojis[Math.floor(Math.random() * techEmojis.length)];
          iconsHtml += `<div class="floating-icon">${randomEmoji}</div>`;
        }
        container.innerHTML = iconsHtml;
      }
    });
  </script>
</body>
</html>